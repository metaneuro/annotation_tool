(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{436:function(t,e,n){"use strict";n.r(e);var l=n(0);n(5),n(264),n(1),n(263),n(60),n(77),n(19),n(22),n(64),n(48),n(11),n(4),n(65),n(76),n(54);function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,l=function(){};return{s:l,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,f=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){f=!0,r=t},f:function(){try{c||null==n.return||n.return()}finally{if(f)throw r}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var c={props:{details:{default:function(){},required:!0,type:Object},idField:{default:function(){},required:!0,type:String},relevantColumns:{default:function(){return[]},required:!0,type:Array},title:{type:String,required:!0},uniqueValues:{default:function(){},required:!0,type:Object},uniqueValuesToSubjectMap:{default:function(){},required:!0,type:Object}},inject:["dataTable","isMissingValue","valueDescription"],name:"AnnotToolGroup",data:function(){return{availableSubjects:0,totalSubjects:0,fields:["column_name","raw_value","description","missing_value"],tableItems:{},uiText:{availability:"Subjects available for this tool group: ",generalInstructions:"Indicate which values are 'missing' for each column in the group",missingValueButton:"Mark as missing",saveButton:"Save Annotation"},subjectAvailability:{}}},watch:{"$store.state.missingColumnValues":{deep:!0,handler:function(t,e){this.refreshTableItems()}},subjectAvailability:{deep:!0,handler:function(t,e){for(var n=this.totalSubjects,l=0,r=Object.keys(this.subjectAvailability);l<r.length;l++){var o=r[l],c=!0;for(var f in this.subjectAvailability[o])if(!this.subjectAvailability[o][f]){c=!1;break}if(!c&&(n-=1)<0){n=0;break}}this.availableSubjects=n}}},created:function(){this.totalSubjects=this.availableSubjects=this.dataTable.original.length,this.initalizeAvailabilityMap()},mounted:function(){this.refreshTableItems()},methods:{applyAnnotation:function(){for(var t=structuredClone(this.dataTable.annotated),e=0;e<t.length;e++){var n=!0;for(var l in t[e])if(this.relevantColumns.includes(l)&&!this.subjectAvailability[t[e][this.idField]][l]){n=!1;break}t[e][this.details.groupName+"_avail"]=n}this.$emit("update:dataTable",{transformedTable:t})},declareMissing:function(t){this.setSubjectAvailability(t.column_name,t.raw_value,!1),this.$emit("update:missingValue",{column:t.column_name,value:t.raw_value})},initalizeAvailabilityMap:function(){this.subjectAvailability={};var t,e=r(this.dataTable.original);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.subjectAvailability[n[this.idField]]={};var l,o=r(this.relevantColumns);try{for(o.s();!(l=o.n()).done;){var c=l.value;this.subjectAvailability[n[this.idField]][c]=!0}}catch(t){o.e(t)}finally{o.f()}}}catch(t){e.e(t)}finally{e.f()}},refreshTableItems:function(){this.tableItems={};var t,e=r(this.relevantColumns);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.tableItems[n]=[]}}catch(t){e.e(t)}finally{e.f()}for(var l in this.uniqueValues){var o,c=r(this.uniqueValues[l]);try{for(c.s();!(o=c.n()).done;){var f=o.value;if(!this.isMissingValue(l,f)){var v=this.valueDescription(l,f);this.tableItems[l].push({column_name:l,description:v,raw_value:f}),this.setSubjectAvailability(l,f,!0)}}}catch(t){c.e(t)}finally{c.f()}}},setSubjectAvailability:function(t,e,n){var o,c=r(this.uniqueValuesToSubjectMap[t][e]);try{for(c.s();!(o=c.n()).done;){var f=o.value,v=Object.assign(this.subjectAvailability[f],Object(l.a)({},t,n));this.subjectAvailability=Object.assign({},this.subjectAvailability,Object(l.a)({},t,v))}}catch(t){c.e(t)}finally{c.f()}}}},f=n(59),component=Object(f.a)(c,(function(){var t=this,e=t._self._c;return e("div",[e("b-card",{staticClass:"annotation-card"},[e("b-card-header",[e("b-row",[e("b-col",{staticClass:"text-left",attrs:{cols:"5"}},[t._v("\n                    "+t._s(t.uiText.generalInstructions)+"\n                ")]),t._v(" "),e("b-col",{attrs:{cols:"2"}}),t._v(" "),e("b-col",{staticClass:"text-right",attrs:{cols:"5"}},[t._v("\n                    "+t._s(t.uiText.availability+t.availableSubjects+" out of "+t.totalSubjects)+"\n                ")])],1)],1),t._v(" "),e("b-card-body",[e("b-tabs",{attrs:{"content-class":"mt-3"}},t._l(t.relevantColumns,(function(n,l){return e("b-tab",{key:n,attrs:{active:0===l,title:n}},[e("b-table",{attrs:{"data-cy":"annot-tool-group-table-"+t.title,fixed:"",striped:"",fields:t.fields,items:t.tableItems[n]},scopedSlots:t._u([{key:"cell(missing_value)",fn:function(n){return[e("b-button",{attrs:{variant:"danger"},on:{click:function(e){return t.declareMissing(n.item)}}},[t._v("\n                                "+t._s(t.uiText.missingValueButton)+"\n                            ")])]}}],null,!0)})],1)})),1)],1)],1),t._v(" "),e("b-row",[e("b-button",{attrs:{"data-cy":"save-button-"+t.title,variant:"success"},on:{click:function(e){return t.applyAnnotation()}}},[t._v("\n            "+t._s(t.uiText.saveButton)+"\n        ")])],1)],1)}),[],!1,null,null,null);e.default=component.exports}}]);